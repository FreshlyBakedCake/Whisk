---
import Layout from '../layouts/Global.astro';

import Card from '../components/Card.astro';

import { getSecret } from 'astro:env/server';

import { getCollection } from 'astro:content';

const blogEntries = await getCollection('blog', ({ data }) => {
	return data.published == true;
})
---

<Layout pageTitle={getSecret("BLOG_TITLE")}>
	<ul class="flex gap-6 w-1/2 h-full">
		{
		blogEntries
		.sort((a,b) => (b.data.publishedOn ?? new Date("1980-01-01")).getTime() - (a.data.publishedOn ?? new Date("1980-01-01")).getTime())
		.map(async post => <Card postId={post.id} />)
		}
	</ul>
</Layout>
